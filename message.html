<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¯ÙŠÙƒ Ø±Ø³Ø§Ù„Ø© Ø­Ø¨ Ø®Ø§ØµØ© ğŸ’–</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background: #ff4d6d; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; color: #333; }
        #startScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ff4d6d; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; cursor: pointer; }
        .main-heart { font-size: 150px; animation: beat 0.8s infinite; filter: drop-shadow(0 0 20px rgba(255,255,255,0.5)); }
        .heart-names { color: white; font-weight: bold; font-size: 1.5rem; margin-top: 20px; text-align: center; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        @keyframes beat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .card { background: white; width: 85%; max-width: 500px; padding: 30px; border-radius: 30px; text-align: center; box-shadow: 0 20px 40px rgba(0,0,0,0.3); display: none; position: relative; z-index: 10; }
        .user-photo { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 5px solid #ffccd5; margin: 0 auto 15px; display: none; }
        .typing-text { font-size: 1.4rem; line-height: 1.6; color: #590d22; min-height: 100px; margin: 20px 0; background: #fff0f3; padding: 20px; border-radius: 20px; }
        .floating-emoji { position: fixed; pointer-events: none; z-index: 1; animation: floatUp 4s forwards; font-size: 24px; }
        @keyframes floatUp { 0% { transform: translateY(100vh) scale(0); opacity: 0; } 50% { opacity: 1; } 100% { transform: translateY(-10vh) scale(1.5); opacity: 0; } }
        .love-burst { position: absolute; color: #ff4d6d; font-weight: bold; font-size: 1.2rem; animation: burst 2s forwards; white-space: nowrap; pointer-events: none; }
        @keyframes burst { 0% { opacity: 0; transform: scale(0.5); } 50% { opacity: 1; } 100% { opacity: 0; transform: translateY(-50px) scale(1.2); } }
        .btn-again { display: inline-block; margin-top: 20px; text-decoration: none; background: #ff4d6d; color: white; padding: 10px 20px; border-radius: 50px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="startScreen" onclick="startSurprise()">
        <div class="main-heart">â¤ï¸</div>
        <div class="heart-names" id="namesOnHeart"></div>
        <p style="color: white; margin-top: 10px;">Ø¥Ù„Ù…Ø³ Ø§Ù„Ù‚Ù„Ø¨ Ù„Ø³Ù…Ø§Ø¹ Ø§Ù„Ø£ØºÙ†ÙŠØ© ÙˆØ±Ø¤ÙŠØ© Ø§Ù„Ù…ÙØ§Ø¬Ø£Ø© ğŸ‘†</p>
    </div>

    <div class="card" id="mainCard">
        <img id="viewPhoto" class="user-photo">
        <h2 id="viewReceiver" style="color: #ff4d6d;"></h2>
        <div class="typing-text" id="typewriter"></div>
        <div id="lovePhrases" style="height: 30px; color: #ff4d6d; font-weight: bold;"></div>
        <div style="margin-top: 15px; font-weight: bold;">Ù…Ù† Ø­Ø¨ÙŠØ¨Ùƒ: <span id="viewSender"></span></div>
        <a href="index.html" class="btn-again">Ø£Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø­Ø¨ ğŸ¥°</a>
    </div>

    <audio id="userMusic" loop></audio>

<script>
    const params = new URLSearchParams(window.location.search);
    const encodedData = params.get('msg');
    let messageData = null;

    if (encodedData) {
        try {
            messageData = JSON.parse(decodeURIComponent(escape(atob(encodedData))));
            document.getElementById('namesOnHeart').innerText = `${messageData.s} â¤ï¸ ${messageData.r}`;
        } catch(e) {
            document.body.innerHTML = "<h1>Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ ğŸ˜¢</h1>";
        }
    }

    function startSurprise() {
        document.getElementById('startScreen').style.display = 'none';
        document.getElementById('mainCard').style.display = 'block';

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø© Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª
        if (messageData.a) {
            const audio = document.getElementById('userMusic');
            audio.src = messageData.a;
            audio.play().catch(e => console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª"));
        }

        document.getElementById('viewReceiver').innerText = "Ø¥Ù„Ù‰: " + messageData.r;
        document.getElementById('viewSender').innerText = messageData.s;
        if (messageData.p) {
            const img = document.getElementById('viewPhoto');
            img.src = messageData.p;
            img.style.display = 'block';
        }

        startTyping(messageData.m);
        startFloatingEmojis();
    }

    function startTyping(text) {
        const div = document.getElementById('typewriter');
        const phrases = ["ğŸ˜˜ğŸ˜ Ø¨Ø­Ø¨Ùƒ ğŸ˜ğŸ˜˜", "ğŸ¥°ğŸ¥° Ø¨Ø¹Ø´Ù‚Ùƒ ğŸ¥°ğŸ¥°", "ğŸ’‹ ÙˆØ­Ø´ØªÙ†ÙŠ ğŸ’‹", "â¤ï¸ ÙŠØ§ Ø±ÙˆØ­ÙŠ â¤ï¸"];
        let i = 0;
        function type() {
            if (i < text.length) {
                div.innerHTML += text.charAt(i);
                i++;
                if (i % 15 === 0) {
                    const phrase = phrases[Math.floor(Math.random() * phrases.length)];
                    document.getElementById('lovePhrases').innerText = phrase;
                }
                setTimeout(type, 100);
            }
        }
        type();
    }

    function startFloatingEmojis() {
        const emojis = ['ğŸ¥°','ğŸ˜˜','ğŸ˜','â¤ï¸','ğŸ’‹','ğŸ’–','ğŸ’—','ğŸ’“','ğŸ’','ğŸ’•','â£ï¸','ğŸ’‹'];
        setInterval(() => {
            const el = document.createElement('div');
            el.className = 'floating-emoji';
            el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
            el.style.left = Math.random() * 100 + 'vw';
            el.style.top = '100vh';
            el.style.animationDuration = (Math.random() * 2 + 2) + 's';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 4000);
        }, 150);
    }
</script>
</body>
</html>
